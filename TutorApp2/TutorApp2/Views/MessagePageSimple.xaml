<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="TutorApp2.Models.MessagePageSimple"
             xmlns:plugin="clr-namespace:ImageCircle.Forms.Plugin.Abstractions;assembly=ImageCircle.Forms.Plugin">

    <ContentPage.Content>
        <StackLayout>
            <StackLayout>
                <Label Text="Welcome to Xamarin.Forms!"
                VerticalOptions="CenterAndExpand" 
                HorizontalOptions="CenterAndExpand" />
            </StackLayout>

            <!--Messages in Row 0 -->
            <StackLayout Padding="30">
                <ListView ItemsSource="{Binding .}">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <ViewCell>
                                <StackLayout>
                                    <StackLayout IsVisible="{Binding IsIncoming}">
                                        <Grid ColumnSpacing="2" Padding="5" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="40"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                                <ColumnDefinition Width="40"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*"></RowDefinition>
                                                <RowDefinition Height="Auto"></RowDefinition>
                                            </Grid.RowDefinitions>
                                            <plugin:CircleImage
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        HeightRequest="35"
                                        WidthRequest="35"
                                        BorderThickness="2"
                                        BorderColor="#03A9F4"
                                        Aspect="AspectFill"
                                        HorizontalOptions="Center"
                                        VerticalOptions="Center" Source="LoginIcon.jpg"/>
                                            <Label Text="{Binding Sender}" Grid.Row="0" Grid.Column="1"
                                TextColor="#f35e20" />
                                            <StackLayout  HorizontalOptions="StartAndExpand" VerticalOptions="Start"  Grid.Row="0" Grid.Column="1">
                                                <Frame OutlineColor="Black" VerticalOptions="Fill" >
                                                    <Label HorizontalOptions="EndAndExpand" TextColor="Blue"  Text="tettt" VerticalOptions="Fill"  ></Label>
                                                </Frame>
                                            </StackLayout>
                                            <Label FontSize="Micro" Grid.Row="1" Grid.Column="1" Text="{Binding TimeStamp, StringFormat=' {0:MM/dd/yyyy hh:mm tt} '}" TextColor="Gray"></Label>

                                        </Grid>
                                    </StackLayout>
                                    <StackLayout IsVisible="{Binding IsOutgoing}">
                                        <Grid ColumnSpacing="2" Padding="5" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="40"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                                <ColumnDefinition Width="40"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*"></RowDefinition>
                                                <RowDefinition Height="Auto"></RowDefinition>

                                            </Grid.RowDefinitions>
                                            <plugin:CircleImage
                                          Grid.Row="0"
                                          Grid.Column="2"
                                          HeightRequest="35"
                                          WidthRequest="35"
                                          BorderThickness="2"
                                          BorderColor="#03A9F4"
                                          Aspect="AspectFill"
                                          HorizontalOptions="Center"
                                          VerticalOptions="Center" Source="LoginIcon.jpg" ></plugin:CircleImage>
                                            <Label Text="{Binding Sender}" Grid.Row="0" Grid.Column="1"
                                TextColor="#f35e20" HorizontalTextAlignment="End"/>
                                            <Frame Grid.Row="0"  Grid.Column="1">
                                                <Frame.HasShadow>
                                                    <OnPlatform x:TypeArguments="x:Boolean" iOS="false" Android="true"/>
                                                </Frame.HasShadow>
                                                <Frame.BackgroundColor>
                                                    <OnPlatform x:TypeArguments="Color" iOS="#F5F5F5" Android="White"/>
                                                </Frame.BackgroundColor>
                                                <StackLayout  Grid.Row="0" Grid.Column="1"  HorizontalOptions="StartAndExpand" VerticalOptions="Start">
                                                    <Frame OutlineColor="Black" Grid.Row="0" Grid.Column="1"  >
                                                        <Label HorizontalOptions="EndAndExpand" VerticalOptions ="End" Grid.Row="0" Grid.Column="1" TextColor="Blue"  Text="tettt"></Label>
                                                    </Frame>
                                                </StackLayout>
                                            </Frame>
                                            <Label Grid.Row="1" FontSize="Micro" Grid.Column="1" HorizontalTextAlignment="End"  Text="{Binding TimeStamp, StringFormat=' {0:MM/dd/yyyy hh:mm tt} '}" TextColor="Gray"></Label>

                                        </Grid>
                                    </StackLayout>
                                </StackLayout>
                            </ViewCell>
                        </DataTemplate>

                    </ListView.ItemTemplate>
                </ListView>
            </StackLayout>
            <StackLayout Padding="30">
                <Grid ColumnSpacing="2" Padding="5" >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="100"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                        <ColumnDefinition Width="100"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Entry Grid.Row="0"  Grid.Column="0" x:Name="Messagetosend" VerticalOptions="End" HorizontalOptions="StartAndExpand"></Entry>
                    <Button Grid.Row="0"  Grid.Column="1"  x:Name="Btn_SendMessage" Text="Send" Clicked="SendMessage" VerticalOptions="End" HorizontalOptions="End"/>
                </Grid>
            </StackLayout>
        </StackLayout>
    </ContentPage.Content>
</ContentPage>